---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import {SITE_TITLE, SITE_DESCRIPTION} from '../consts';
import {getCollection} from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
  (a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
<head>
  <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION}/>
</head>
<body>
<main class="flex flex-col gap-12 h-fit p-8">
  <Header/>

  <section class="flex justify-center">
    <ul class="flex flex-col gap-4">
      {
        posts.map((post) => (
          <li class="border border-gray-200 rounded p-4 hover:bg-gray-100 hover:text-gray-700">
            <div class="flex flex-col gap-2">
              <p class="">{post.data.content}</p>

              {post.data.image &&
                <div class="self-center"><a href={post.data.image}>
                  <img class="rounded-lg" width={720} height={480} src={post.data.image}
                       alt="post image"/>
                </a></div>}

              <div class="flex justify-between gap-32">
                <p class="text-gray-700 cursor-default">{post.data.id}</p>

                <p class="self-end cursor-default">
                  posted on
                  <FormattedDate date={post.data.pubDate}/>
                </p>
              </div>
            </div>
          </li>
        ))
      }
    </ul>
  </section>
</main>
</body>
</html>
